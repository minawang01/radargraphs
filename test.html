<html>
    <head>
        <title>Test</title>
        <script src="https://d3js.org/d3.v6.js"></script>
        <script src="https://d3js.org/d3-path.v2.min.js"></script>
        <script src="https://d3js.org/d3-shape.v2.min.js"></script>
    </head>
    <body>
        <div id="svgcontainer"></div>
    </body>
    <script>
        var toPolar = (degree, r) => {
    return {
        xPoint: r*Math.sin(degree*Math.PI/180),
        yPoint: r*Math.cos(degree*Math.PI/180)
    }
}
        let svgheight = 600;
    let svgwidth = 600;
    let center = svgheight/2;
    let d = svgheight - 70;
    var radarScale = d3.scaleLinear()
        .domain([0, 1])
        .range([0, d/2]);

    let svg = d3.select("#svgcontainer")
            .append("svg")
            .attr("height", svgheight)
            .attr("width", svgwidth);
        let scale = [0, 0.2, 0.4, 0.6, 0.8, 1];
    let stats = [["danceability", 0.7],
         ["energy", 0.54],
         ["speechiness", 0.32],
         ["acousticness", 0.4],
         ["instrumentalness", 0.9],
         ["liveness", 0.25]];
        svg.selectAll("circle")
            .data(scale)
            .enter()
            .append("circle")
            .attr("cx", center)
            .attr("cy", center)
            .attr("r", (i) => radarScale(i))
            .style("stroke", "black")
            .style("fill", "none")
            .style("stroke-width", 1);
            
        for(let i = 0; i < 6; i++) {
            let line = svg.append("line")
            .style("stroke", "black")
            .style("stroke-width", 1)
            .attr("x1", center)
            .attr("y1", center)
            .attr("x2", center + toPolar((i/6)*360, d/2).xPoint)
            .attr("y2", center + toPolar((i/6)*360, d/2).yPoint);

            svg.append("text")
            .attr("y", center + toPolar((i/6)*360, d/2 + 15).yPoint)
            .attr("x", center + toPolar((i/6)*360, d/2 + 15).xPoint)
            .attr("text-anchor", "middle")
            .text(stats[i][0]);
        }


    let allStats = [
        [0,0],
        [0,0],
        [0,0],
        [0,0],
        [0,0],
        [0,0],
    ];

    for(let i = 0; i < stats.length; i++) {
        allStats[i][0] = center + toPolar((i/6)*360, radarScale(stats[i][1])).xPoint;
        allStats[i][1] =  center + toPolar((i/6)*360, radarScale(stats[i][1])).yPoint;
    }
    let poly = svg.selectAll("polygon")
    .data([allStats])
    .enter()
    .append("polygon")
    .style("stroke-width", 2)
    .style("stroke", "cyan")
    .attr("points", (d) => {
        let str = "";
        for(let i = 0; i < d.length; i++) {
            str = str+d[i][0]+","+d[i][1]+" ";
        }
        return str;
    })
    .style("fill", "cyan")
    .style("fill-opacity", 0.8)
    .on("mouseover", function(d) {
        let z = "polygon."+d3.select(this).attr("class");
        d3.selectAll("polygon")
        .transition(200)
        .style("fill-opacity", 0.1);
        d3.selectAll(z)
        .transition(200)
        .style("fill-opacity", 0.7);
    })
    .on("mouseout", function(d) {
        d3.selectAll("polygon")
        .transition(200)
        .style("fill-opacity", 0.8)
    });

    let mouse = d3.select("#svgcontainer").append("div").attr("class", "mouse");
    for(let i = 0; i < allStats.length; i++) {
        svg.append("circle")
            .attr("cx", allStats[i][0])
            .attr("cy", allStats[i][1])
            .attr("r", 5)
            .style("stroke", "cyan")
            .style("stroke-width", "2px")
            .style("fill", "cyan")
            .on("mouseover", (d) => {
                console.log("Hello");
                mouse.style("position", "absolute").style("left", (allStats[i][0] - 40) + "px")
                .style("top", (allStats[i][1] - 80) + "px")
                .style("display", "inline-block")
                .html(stats[i][0]+ "<br><span>"+ stats[i][1] +"</span>");
            })
            .on("mouseout", () => {
                mouse.style("display", "none");
            })
    }

    
  



    /*let line = d3.line();
    svg.append("path")
    .data([allStats])
    .attr("d", line)
    .style("fill", "cyan")
    .style("stroke", "black")
    .style("fill-opacity", 0.8)
    .style("stroke-width", 1.5)
    .on("mouseover", (d) => {
        d3.select(this)
        .transition()
        .duration(50)
        .style("opacity", 0.1);
    })
    .on("mouseout", (d) => {
        d3.select(this)
        .transition(200)
        .style("opacity", 0.8);
    });*/
    </script>
</html>